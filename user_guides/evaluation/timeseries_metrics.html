
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Time Series Metrics &#8212; SDV 0.12.1 documentation</title>
    
  <link rel="stylesheet" href="../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sdv.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../../_static/SDV-Logo-Black.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Benchmarking Framework" href="../benchmarking/index.html" />
    <link rel="prev" title="Multi Table Metrics" href="multi_table_metrics.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

    <a class="navbar-brand" href="../../index.html">
    
      <img src="../../_static/SDV-Logo-Color.png" class="logo" alt="logo" />
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../../getting_started/index.html">Getting Started</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="../index.html">User Guides</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../api_reference/index.html">API Reference</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../developer_guides/index.html">Developer Guides</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../history.html">Release Notes</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/sdv-dev/SDV" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
          <li class="nav-item">
            <a class="nav-link" href="https://twitter.com/sdv_dev" target="_blank" rel="noopener">
              <span><i class="fab fa-twitter-square"></i></span>
            </a>
          </li>
        
        
          <li class="nav-item">
            <a class="nav-link" href="https://join.slack.com/t/sdv-space/shared_invite/zt-gdsfcb5w-0QQpFMVoyB2Yd6SRiMplcw" target="_blank" rel="noopener">
              <img class="nav-icon-img" src="../../_static/slack-32.png">
            </a>
          </li>
        
      </ul>
    </div>
</div>

    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
    
    <ul class="nav bd-sidenav">
        
        
        
        
          
            
                <li class="">
                    <a href="../single_table/index.html">Single Table Data</a>
                </li>
            
          
            
                <li class="">
                    <a href="../relational/index.html">Relational Data</a>
                </li>
            
          
            
                <li class="">
                    <a href="../timeseries/index.html">Timeseries Data</a>
                </li>
            
          
            
                <li class="active">
                    <a href="index.html">Synthetic Data Evaluation</a>
                    <ul>
                    
                        
                            <li class="">
                                <a href="evaluation_framework.html">Evaluation Framework</a>
                            </li>
                        

                    
                        
                            <li class="active">
                                <a href="synthetic_data_metrics.html">Synthetic Data Metrics</a>
                                <ul>
                                
                                    <li class="">
                                        <a href="single_table_metrics.html">Single Table Metrics</a>
                                    </li>
                                
                                    <li class="">
                                        <a href="multi_table_metrics.html">Multi Table Metrics</a>
                                    </li>
                                
                                    <li class="active">
                                        <a href="">Time Series Metrics</a>
                                    </li>
                                
                                </ul>
                            </li>
                        

                    
                    </ul>
                </li>
            
          
            
                <li class="">
                    <a href="../benchmarking/index.html">Benchmarking Framework</a>
                </li>
            
          
        
        
        
        
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#time-series-metric-families" class="nav-link">Time Series Metric Families</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#detection-metrics" class="nav-link">Detection Metrics</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#machine-learning-efficacy-metrics" class="nav-link">Machine Learning Efficacy Metrics</a>
        </li>
    
            </ul>
        </li>
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="time-series-metrics">
<span id="timeseries-metrics"></span><h1>Time Series Metrics<a class="headerlink" href="#time-series-metrics" title="Permalink to this headline">¶</a></h1>
<p>In this section we will show you which metrics exist for time series datasets and
how to use them.</p>
<p>Let us start by loading some demo data that we will use to explore the different
metrics that exist.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">sdv.metrics.demos</span> <span class="kn">import</span> <span class="n">load_timeseries_demo</span>

<span class="gp">In [2]: </span><span class="n">real_data</span><span class="p">,</span> <span class="n">synthetic_data</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">load_timeseries_demo</span><span class="p">()</span>
</pre></div>
</div>
<p>This will return us three objects:</p>
<p>The <code class="docutils literal notranslate"><span class="pre">real_data</span></code>, which is the time series <code class="docutils literal notranslate"><span class="pre">sunglasses</span></code> demo dataset:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [3]: </span><span class="n">real_data</span>
<span class="gh">Out[3]: </span><span class="go"></span>
<span class="go">          date  store_id      region  day_of_week  total_sales  nb_customers</span>
<span class="go">0   2020-06-01     68608    New York            0       736.19            43</span>
<span class="go">1   2020-06-02     68608    New York            1       777.31            45</span>
<span class="go">2   2020-06-03     68608    New York            2       921.22            54</span>
<span class="go">3   2020-06-04     68608    New York            3      1085.69            63</span>
<span class="go">4   2020-06-05     68608    New York            4      1476.30            86</span>
<span class="go">..         ...       ...         ...          ...          ...           ...</span>
<span class="go">695 2020-06-03     75193  California            2      3100.43           182</span>
<span class="go">696 2020-06-04     75193  California            3      3244.34           190</span>
<span class="go">697 2020-06-05     75193  California            4      3593.84           211</span>
<span class="go">698 2020-06-06     75193  California            5      4518.98           265</span>
<span class="go">699 2020-06-07     75193  California            6      3429.37           201</span>
<span class="go">.</span>
<span class="go">[700 rows x 6 columns]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">synthetic_data</span></code>, which is a clone of the <code class="docutils literal notranslate"><span class="pre">real_data</span></code> which has been generated
by the <code class="docutils literal notranslate"><span class="pre">PAR</span></code> timeseries model.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="n">synthetic_data</span>
<span class="gh">Out[4]: </span><span class="go"></span>
<span class="go">          date  store_id      region  day_of_week  total_sales  nb_customers</span>
<span class="go">0   2020-06-01         0    New York            0   762.349155            43</span>
<span class="go">1   2020-06-02         0    New York            1   809.673681            42</span>
<span class="go">2   2020-06-03         0    New York            2   950.915155            60</span>
<span class="go">3   2020-06-04         0    New York            3  1137.295165            62</span>
<span class="go">4   2020-06-05         0    New York            4  1517.681393            94</span>
<span class="go">..         ...       ...         ...          ...          ...           ...</span>
<span class="go">695 2020-06-03        99  California            1  3042.781939           174</span>
<span class="go">696 2020-06-04        99  California            2  3183.143605           185</span>
<span class="go">697 2020-06-05        99  California            4  3541.943027           180</span>
<span class="go">698 2020-06-06        99  California            5  2978.115245           169</span>
<span class="go">699 2020-06-07        99  California            6  5427.324077           141</span>
<span class="go">.</span>
<span class="go">[700 rows x 6 columns]</span>
</pre></div>
</div>
<p>And a <code class="docutils literal notranslate"><span class="pre">metadata</span></code>, which is the <code class="docutils literal notranslate"><span class="pre">dict</span></code> representation of the <code class="docutils literal notranslate"><span class="pre">student_placements</span></code> metadata.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="n">metadata</span>
<span class="gh">Out[5]: </span><span class="go"></span>
<span class="go">{&#39;fields&#39;: {&#39;region&#39;: {&#39;type&#39;: &#39;categorical&#39;},</span>
<span class="go">  &#39;store_id&#39;: {&#39;type&#39;: &#39;numerical&#39;, &#39;subtype&#39;: &#39;integer&#39;},</span>
<span class="go">  &#39;nb_customers&#39;: {&#39;type&#39;: &#39;numerical&#39;, &#39;subtype&#39;: &#39;integer&#39;},</span>
<span class="go">  &#39;total_sales&#39;: {&#39;type&#39;: &#39;numerical&#39;, &#39;subtype&#39;: &#39;float&#39;},</span>
<span class="go">  &#39;date&#39;: {&#39;type&#39;: &#39;datetime&#39;},</span>
<span class="go">  &#39;day_of_week&#39;: {&#39;type&#39;: &#39;numerical&#39;, &#39;subtype&#39;: &#39;integer&#39;}},</span>
<span class="go"> &#39;entity_columns&#39;: [&#39;store_id&#39;],</span>
<span class="go"> &#39;sequence_index&#39;: &#39;date&#39;,</span>
<span class="go"> &#39;context_columns&#39;: [&#39;region&#39;]}</span>
</pre></div>
</div>
<p>These three elements, or their corresponding equivalents, are all you will need to
run most of the <em>Time Series Metrics</em> on your own <em>Synthetic Dataset</em>.</p>
<section id="time-series-metric-families">
<h2>Time Series Metric Families<a class="headerlink" href="#time-series-metric-families" title="Permalink to this headline">¶</a></h2>
<p>The <em>Time Series Metrics</em> are grouped in multiple families:</p>
<ul class="simple">
<li><p><strong>Detection Metrics</strong>: These metrics try to train a Machine Learning Classifier that learns
to distinguish the real data from the synthetic data, and report a score of how successful
this classifier is.</p></li>
<li><p><strong>Machine Learning Efficacy Metrics</strong>: These metrics train a Machine Learning model on your
synthetic data and later on evaluate the model performance on the real data. Since these
metrics need to evaluate the performance of a Machine Learning model on the dataset, they
work only on datasets that represent a Machine Learning problem.</p></li>
</ul>
<section id="detection-metrics">
<h3>Detection Metrics<a class="headerlink" href="#detection-metrics" title="Permalink to this headline">¶</a></h3>
<p>The metrics of this family evaluate how hard it is to distinguish the synthetic data from the
real data by using a Machine Learning model. To do this, the metrics will shuffle the real
data and synthetic data together with flags indicating whether the data is real or synthetic,
and then cross validate a Machine Learning model that tries to predict this flag using a
rectified version of a ROC AUC score that returns values in the range [0, 1].
The output of the metrics will be the 1 minus the average of the score across all the cross
validation splits.</p>
<p>Such metrics are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sdv.metrics.timeseries.LSTMDetection</span></code>: Detection metric based on an <code class="docutils literal notranslate"><span class="pre">LSTM</span></code> classifier
implemented using <code class="docutils literal notranslate"><span class="pre">PyTorch</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sdv.metrics.timeseries.TSFCDetection</span></code>: Detection metric based on a
<code class="docutils literal notranslate"><span class="pre">TimeSeriesForestClassifier</span></code> pipeline implemented using <code class="docutils literal notranslate"><span class="pre">sktime</span></code>.</p></li>
</ul>
<p>Let us execute these metrics on the loaded data:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="kn">from</span> <span class="nn">sdv.metrics.timeseries</span> <span class="kn">import</span> <span class="n">LSTMDetection</span><span class="p">,</span> <span class="n">TSFCDetection</span>

<span class="gp">In [7]: </span><span class="n">LSTMDetection</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">real_data</span><span class="p">,</span> <span class="n">synthetic_data</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span>
<span class="gh">Out[7]: </span><span class="go">0.5</span>

<span class="gp">In [8]: </span><span class="n">TSFCDetection</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">real_data</span><span class="p">,</span> <span class="n">synthetic_data</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span>
<span class="gh">Out[8]: </span><span class="go">0.0</span>
</pre></div>
</div>
</section>
<section id="machine-learning-efficacy-metrics">
<h3>Machine Learning Efficacy Metrics<a class="headerlink" href="#machine-learning-efficacy-metrics" title="Permalink to this headline">¶</a></h3>
<p>This family of metrics will evaluate whether it is possible to replace the real data with
synthetic data in order to solve a Machine Learning Problem by learning a Machine Learning
model on both the synthetic data and real data and then comparing the score which they
obtain when evaluated on held out real data. The output is the score obtained by the model
fitted on synthetic data divided by the score obtained when fitted on real data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since this metrics will be evaluated by trying to solve a Machine Learning problem,
they can only be used on datasets that contain a target column that needs or can be predicted
using the rest of the data, and the scores returned by the metrics will be useful only
if the Machine Learning problem is relatively easy to solve. Otherwise, if the performance
of the models when fitted on real data is too low, the output from these metrics may be
meaningless.</p>
</div>
<p>The metrics on this family are organized by Machine Learning problem type and model.</p>
<ul>
<li><p>Classification Metrics:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TSFClassifierEfficacy</span></code>: Efficacy metric based on a <code class="docutils literal notranslate"><span class="pre">TimeSeriesForestClassifier</span></code> from
<code class="docutils literal notranslate"><span class="pre">sktime</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LSTMClassifierEfficacy</span></code>: Efficacy metric based on an LSTM Classifier implemented using
<code class="docutils literal notranslate"><span class="pre">PyTorch</span></code>.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p>In order to run these metrics we will need to select a column from our dataset which we will
use as the target for the prediction problem. For example, in the demo dataset we can try to
predict the <code class="docutils literal notranslate"><span class="pre">region</span></code> of the store based on the sequence items.</p>
<p>Let’s try that:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [9]: </span><span class="kn">from</span> <span class="nn">sdv.metrics.timeseries</span> <span class="kn">import</span> <span class="n">TSFClassifierEfficacy</span>

<span class="gp">In [10]: </span><span class="n">TSFClassifierEfficacy</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">real_data</span><span class="p">,</span> <span class="n">synthetic_data</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;region&#39;</span><span class="p">)</span>
<span class="gh">Out[10]: </span><span class="go">1</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Apart from passing the <code class="docutils literal notranslate"><span class="pre">target</span></code> variable as an argument, we can also store its
value inside the <code class="docutils literal notranslate"><span class="pre">metadata</span></code> dict and pass it to the metric:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;region&#39;</span>

<span class="gp">In [12]: </span><span class="n">TSFClassifierEfficacy</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">real_data</span><span class="p">,</span> <span class="n">synthetic_data</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;region&#39;</span><span class="p">)</span>
<span class="gh">Out[12]: </span><span class="go">1.0</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="multi_table_metrics.html" title="previous page">Multi Table Metrics</a>
    <a class='right-next' id="next-link" href="../benchmarking/index.html" title="next page">Benchmarking Framework</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-180602145-3', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2018, MIT Data To AI Lab.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.2.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>